#include <tunables/global>

profile nrf52840_dfu_flasher flags=(attach_disconnected,mediate_deleted) {
  #include <abstractions/base>

  network,

  # --- allow s6 init and helpers ---
  /init rix,
  /command/** mr,

  # --- shells and common bins ---
  /bin/** mr,
  /sbin/** mr,
  /usr/bin/** mr,
  /usr/sbin/** mr,
  /usr/lib/** mr,
  /usr/local/bin/** mr,
  /usr/local/lib/** mr,

  # USB serial access
  /dev/ttyACM[0-9]* rw,
  /dev/ttyUSB[0-9]* rw,

  # read system state
  /sys/** r,
  /run/** r,

  # our scripts
  /usr/bin/flash_nrfutil.sh mr,
  /usr/bin/pick_asset.sh mr,

  # working dirs
  /tmp/** rwk,
  /data/** rwk,
  /share/** rwk,

  # default deny for everything else
  deny /** wklx,
}
